\documentclass[CJK]{beamer}
\input{macros.tex}
\input{titlepage.tex}
  \date{}
\begin{document}
\tpage{5}{Contour Integration}


\begin{frame}
  \chtitle{响应教务部号召，开动点名神器}
  \addfig{1.5}{drive.jpg}
  \bch
  请一位同学计算一下$$f(z) = \frac{1}{z^2+4z+1}$$在每个孤立奇点处的留数。
  \ech
\end{frame}


\begin{frame}
\chtitle{本讲内容}
\bch
\bitem
\item{用留数定理计算定积分}
 \eitem
\ech
\end{frame}


\section{Did we ever learn integration?}
\secpage{据说我们学过积分？}{不信谣，不传谣\bye}


\begin{frame}
  \chtitle{例1 (研究生面试题）}
  \bch
  \addfig{0.5}{think1.jpg}

  计算积分$$ \int_0^1 \ln x \, dx. $$
  \ech
\end{frame}

\begin{frame}
  \chtitle{例 1 解答}
  \bch
  $$\int_0^1 \ln x\,dx =\left. \left( x\ln x-x \right)\right\vert^{1}_0 = -1 $$

  \ech
\end{frame}


\begin{frame}
  \chtitle{例2 }
  \bch
  \addfig{0.5}{think1.jpg}

  计算积分$$ \int_0^{2\pi}\frac{1}{2+\cos x} \, dx. $$
  \ech
\end{frame}

\begin{frame}
  \chtitle{例2 解法一（三角函数有理分式标准推土法）}
  \bch
    回忆下高数课学过的(?)的知识：{\blue 凡是三角函数有理分式，{\bf 原则上}都能用变量替换$t = \tan\frac{x}{2}$求出原函数。}

    请先验算：{\blue
    $$ dx = \frac{2dt}{1+t^2}, $$
    $$ \cos x = \frac{1-t^2}{1+t^2} $$
    $$ \sin x = \frac{2t}{1+t^2} $$    
    $$ \tan x = \frac{2t}{1-t^2} $$
    }
  \ech
\end{frame}

\begin{frame}
  \chtitle{例2 解法一（三角函数有理分式标准推土法)}
  \bch
  {\small  
  剩下的就是毫无技巧地推土：
    \bea
    \int \frac{1}{2+\cos x} dx &=& \int \frac{1}{2 + \frac{1-t^2}{1+t^2}} \frac{2dt}{1+t^2} \newl
    &=& \int \frac{2}{3 + t^2 } dt \newl
    &=& \frac{2}{\sqrt{3}} \arctan\frac{t}{\sqrt{3}} + c \newl
    &=& \frac{2}{\sqrt{3}} \arctan\frac{\tan\frac{x}{2}}{\sqrt{3}} + c    
    \eea
  }
  不必为原函数在$x=\pi$不连续而惊慌，利用一下三角函数周期性把积分换到$(-\pi, \pi)$:
  $$ \int_0^{2\pi}\frac{dx}{2+\cos x}  = \int_{-\pi}^{\pi}\frac{dx}{2+\cos x} =\left. \frac{2}{\sqrt{3}} \arctan\frac{\tan\frac{x}{2}}{\sqrt{3}}\right\vert_{-\pi}^{\pi}  = \frac{2\pi}{\sqrt{3}} .$$
  \ech
\end{frame}


\begin{frame}
  \chtitle{例2 解法二 （围道积分法）}
  \bch
  考虑逆时针方向的单位圆$|z|=1$，
  
  \addfig{1}{contour01.png}

  记幅角为$x$，则$z = e^{\ii x}$，请先验算：
  {\blue
    $$dx =\frac{dz}{\ii z}$$
    $$\cos x = \frac{z+\frac{1}{z}}{2}$$
    $$\sin x = \frac{z-\frac{1}{z}}{2\ii}$$    
  }
  \ech
\end{frame}

\begin{frame}
  \chtitle{例2 解法二 （围道积分法）}
  \bch
    \addfig{1}{contour01.png}
  \bea
  \int_0^{2\pi}\frac{1}{2+\cos x} \, dx &=& \oint_C \frac{1}{2+\frac{z+\frac{1}{z}}{2}}\frac{dz}{\ii z} \newl
  &=& -2\ii\oint_C\frac{1}{4z+z^2+1} dz \newl
  &=& -2\ii \left(2\pi\ii \frac{1}{2\sqrt{3}}\right)  \newl
  &=& \frac{2\pi}{\sqrt{3}}
  \eea
  \ech
\end{frame}

\begin{frame}
  \bch

  \bcenter
  \lfig{1.5}{kaisen.jpg}

  其实我更喜欢毫无技巧地推土
  \ecenter
  
  \ech
\end{frame}


\begin{frame}
  \chtitle{例3}
  \bch
  \addfig{1}{think2.jpg}

  计算积分$$ \int_0^{2\pi}\cos^{2n}\theta \, d\theta$$

  \ech
\end{frame}


\begin{frame}
  \chtitle{例3 解法一}
  \bch
  利用一个非常有用的{\blue $B$函数和$\Gamma$函数的关系}来解决问题。

  \skipline
  
  对$\alpha, \beta>0$，$B$函数定义为：
  $$B(\alpha,\beta) = \int_0^1 x^{\alpha-1}(1-x)^{\beta-1}\, dx$$
  它和$\Gamma$函数有如下关系：
  {\blue $$B(\alpha,\beta) = \frac{\Gamma(\alpha)\Gamma(\beta)}{\Gamma(\alpha+\beta)} $$}

  令$x=\cos^2\theta$ 即得到所求积分：
 {\small $$\int_0^{2\pi}\cos^{2n}\theta \,d\theta = 2 \int_0^1x^{n-1/2}(1-x)^{-1/2} dx =2 B(n+\frac{1}{2},\frac{1}{2}) = \frac{\pi}{2^{2n-1}}\frac{(2n)!}{(n!)^2} $$}
  
  \ech
\end{frame}


\begin{frame}
  \chtitle{附：补充证明$B$函数和$\Gamma$函数的关系（技巧似曾相识）}
  \bch
  根据$\Gamma$函数定义：
  $$  \Gamma(\alpha)\Gamma(\beta) = \int_0^\infty u^{\alpha-1}e^{-u} du \int_0^\infty \upsilon^{\beta-1}e^{-\upsilon} d\upsilon    $$
  做替换$u=s^2, \upsilon = t^2$；
  $$  \Gamma(\alpha)\Gamma(\beta) = 4 \int_0^\infty s^{2\alpha-1}e^{-s^2} ds \int_0^\infty t^{2\beta-1}e^{-t^2} dt $$
  然后转换到极坐标$s = r\cos\theta, t = r\sin\theta$；
  $$ \Gamma(\alpha)\Gamma(\beta) = 4 \int_0^\infty  e^{-r^2}r^{2\alpha+2\beta-2}r\,dr \int_0^{\pi/2}\cos^{2\alpha-1}\theta \sin^{2\beta-1}\theta d\theta $$
  最后做变量替换$w = r^2$, $x = \cos^2\theta$，即得证。

  \ech
\end{frame}

\begin{frame}
  \chtitle{例3 解法二 围道积分}
  \bch
  还是取单位圆进行围道积分：

  \addfig{1}{contour01.png}

  
  $$ \int_0^{2\pi}\cos^{2n}x \, dx = \oint_C \left(\frac{1+z^2}{2z}\right)^{2n}\frac{dz}{\ii z}.$$
  等式右边是标准的围道积分，围道内只有$z=0$一个孤立奇点。易看出留数为
  $$\frac{(2n)!}{2^{2n}(n!)^2\ii}$$
  乘以$2\pi\ii$即得积分结果。

  

  
  \ech
\end{frame}



\begin{frame}
  \chtitle{例4}
  \bch
  \addfig{1}{think2.jpg}

  计算积分$$ \int_{-\infty}^\infty e^{-x^2}\cos x \, dx .$$

  
  \ech
\end{frame}


\begin{frame}
  \chtitle{例4 解法一 （级数展开大法）}
  \bch
  回忆热学课上的高斯积分：
  $$\int_{-\infty}^{\infty} e^{-ax^2}\,dx = \sqrt{\pi} a^{-1/2}\, .$$
  两边对$a$求导$n$次并除以$(2n)!$：
  $$\int_{-\infty}^{\infty} \frac{(-1)^nx^{2n}}{(2n)!} e^{-ax^2} \,dx= \sqrt{\pi}\frac{(-\frac{1}{4})^n}{n!} a^{-\frac{1}{2}-n}$$
  {\scriptsize （上面我们用到了$(2n)! = (2^n n!) \times 1\times 3\times 5\times\ldots \times(2n-1)$.)}
    
    令$a=1$并两边对$n$从$0$到$\infty$求和
  $$\int_{-\infty}^{\infty}  e^{-x^2}\cos x\,dx = \sqrt{\pi}e^{-1/4}$$
  \ech
\end{frame}

\begin{frame}
  \chtitle{例4 解法二 围道积分}
  \bch

  \addfig{3.5}{contour02.png}

  在如图的围道上对函数$e^{-x^2}$进行积分。

  容易验证当$R\rightarrow \infty$时，两条短边上的积分趋向于零。因此

  $$\int_{-\infty}^{\infty} e^{-(x+\frac{\ii}{2})^2}dx = \int_{-\infty}^{\infty} e^{-x^2}dx  =\sqrt{\pi}$$
  化简并取实部即得到
  $$\int_{-\infty}^{\infty}  e^{-x^2}\cos x\,dx = \sqrt{\pi}e^{-1/4},$$
  {\scriptsize （思考：取虚部可以得到什么结论）}

  \ech
\end{frame}



\begin{frame}
  \chtitle{例5}
  \bch
  \addfig{1}{think2.jpg}
  计算积分$$ \int_0^{\infty} \frac{\cos{x} - e^{-x}}{x}\, dx.$$
  \ech
\end{frame}


\begin{frame}
  \chtitle{例5 解答概要}
  \bch
  \bmini{0.41}
  \addfig{1.5}{contour03.png}
  \emini
  \bmini{0.54}
  对$\frac{e^{\ii z}}{z}$在如图围道上积分，易估算出当$R\rightarrow \infty$时在$C_R$上积分趋向于零。$\delta\rightarrow 0^+$时在$C_\delta$上积分为$-\frac{\pi}{2}\ii$。因此得到
  \emini
  
  $$\int_0^\infty \frac{e^{\ii x}}{x} dx - \int_0^\infty \frac{e^{- x}}{\ii x} d(\ii x)  = \frac{\pi}{2}\ii$$
  对比两边实部即得
  $$ \int_0^{\infty} \frac{\cos{x} - e^{-x}}{x}\, dx = 0.$$
  {\scriptsize （思考：对比两边虚部得到什么结论？）}
  \ech
\end{frame}



\begin{frame}
  \chtitle{例 6}
  \bch
  \addfig{1}{think3.jpg}
  
  计算积分 $$ \int_0^{\infty} \sin(x^2)\, dx $$
  \ech
\end{frame}




\begin{frame}
  \chtitle{例6 解答概要}
  \bch
  \bmini{0.41}
  \addfig{1.5}{contour04.png}
  \emini
  \bmini{0.54}
  对$e^{\ii z^2}$在如图围道上积分。不难估算出当$R\rightarrow \infty$时在$C_R$上积分趋向于零（请自行补充完整这部分证明）。
  \emini
  
  $$\int_0^\infty e^{\ii x^2} dx - e^{\frac{\pi}{4}\ii}\, \int_0^\infty e^{- x^2}dx  = 0 $$
  对比两边虚部即得
  $$ \int_0^{\infty} \sin(x^2)\,dx = \sqrt{\frac{\pi}{8}} $$ 
  {\scriptsize （思考：对比两边实部得到什么结论？）}
  \ech
\end{frame}

\begin{frame}
  \chtitle{例 7}
  \bch
  \addfig{1}{think4.jpg}
  
  计算积分$$\int_{-\infty}^{\infty}\frac{e^{\alpha x}}{1+e^x} \, dx,$$
  其中实常数$\alpha$满足$0<\alpha<1$。

  \ech
\end{frame}




\begin{frame}
  \chtitle{例7 解答概要}
  \bch
  \addfig{3.5}{contour05.png}
  按如图的围道对$f(z) = \frac{e^{\alpha z}}{1+e^z}$进行积分，并注意到围道内有一个孤立奇点$z=\pi\ii$。 记所求积分为$I$，则有
  $$ (1 - e^{2\pi\alpha\ii})I =2\pi\ii\res{f}{\pi\ii} =  -2\pi \ii e^{\alpha\pi\ii}$$
  从而得出
  $$I = \frac{\pi}{\sin(\alpha\pi)}.$$
  \ech
\end{frame}



\begin{frame}
  \chtitle{$\Gamma$函数的互宇宗量关系}
  \bch
  作变量替换$t =  \frac{e^x}{1+e^x}$，则

  $$ \int_{-\infty}^{\infty}\frac{e^{\alpha x}}{1+e^x} \, dx = \int_0^1 t^{\alpha-1}(1-t)^{-\alpha} dt = B(\alpha, 1-\alpha) $$
  再结合之前的$B$函数和$\Gamma$函数的关系，就得到著名的{\blue
    $\Gamma$函数的互宇宗量关系
    $$\Gamma(\alpha)\Gamma(1-\alpha) = \frac{\pi}{\sin(\pi\alpha)}$$
  }
  用解析延拓的办法可以把上式推广到$\alpha$为任何非整数的情形。
  
 {\scriptsize （请思考：我们是怎样做到从一条线($0<\alpha<1$)出发进行解析延拓的.) }
  \ech
\end{frame}

\begin{frame}
  \chtitle{总结}
  \bch
  \bcenter
  \lfig{2}{blackq.jpg}
  
  完全不知道这些围道哪来的.jpg  
  \ecenter
  \ech
\end{frame}


\begin{frame}
  \chtitle{技艺无止境：留给学神们的思考题\bye}
  \bch
\bea
&& \int_0^{\pi/2}\frac{\sin x}{x^\alpha}\,dx,\ \ \  0<\alpha<1; \newl
&& \int_0^1 \frac{x^{1/4}(1-x)^{3/4}}{(1+x)^3}\, dx; \newl
&& \int_0^{\pi/2} \ln(\sin x) \,dx\,; \newl
&& \int_0^{\infty}\frac{x^{p-\frac{1}{2}}}{(x+a)^p(x+b)^p}\, dx,\ \ \ p>\frac{1}{2}, a>0, b>0. 
\eea
\ech
\end{frame}

\section{Homework}

\begin{frame}
  \chtitle{课后作业}
  \bch
  \bitem
\item[13]{计算积分$$\int_0^{2\pi}\frac{dx}{1-2\alpha\cos x + \alpha^2},$$
其中常数$\alpha$满足$0<\alpha<1$。}
\item[14]{计算积分$$\int_0^\infty \frac{x\sin x}{1+x^2} \,dx.$$}
\item[15]{计算积分$$\int_0^{\infty}\frac{\ln x}{x^2+\alpha^2}dx, $$
其中常数$\alpha>0$。}
  \eitem
  \ech
\end{frame}

\end{document}
