\documentclass[CJK]{beamer}
\input{macros.tex}
\input{titlepage.tex}
  \date{}
  \begin{document}
  \bch
\tpage{28}{非线性微分方程}

\begin{frame}
\frametitle{本讲内容}
\tableofcontents
\end{frame}

\section{Review and Practices}

\begin{frame}
  \frametitle{看看多少人已经下车了}

  \addfig{0.7}{think1.jpg}
  
设方程 $\cot x + x = 0$ 的（按从小到大排列的）第$n$个正数解为 $\alpha_n$。计算积分
$$\int_0^1 \sin\frac{(\alpha_1+\alpha_4)x}{2}\sin\frac{(\alpha_1-\alpha_4)x}{2}\sin\frac{(\alpha_2+\alpha_3)x}{2}\sin\frac{(\alpha_2-\alpha_3)x}{2}  dx$$
的值。
\end{frame}



\begin{frame}
  \frametitle{看看多少人已经下车了}
  \addfig{0.8}{ring12.jpg}

  一个均匀薄圆环，内半径为 $R$，外半径为 $2R$，其材质的热传导方程参数为 $a$。一开始圆环上各处温度为
  $$\left.T\right\vert_{t=0}= T_0\frac{r}{R}\cos\theta,$$
  其中 $(r,\theta)$ 是以圆环中心为原点建立的极坐标 ($R\le r\le 2R, 0\le\theta\le 2\pi$)。求 $t>0$ 时圆环上各点温度的变化。
  
\end{frame}


\begin{frame}
  \frametitle{空心球问题举例($7\star$)}

  内半径为 $0.1\mathrm{m}$，外半径为 $0.2\mathrm{m}$ 的均匀空心球。其材质的热传导方程参数为$a=10^{-4}\mathrm{m^2s^{-1}}$；其初始温度为 $0^\circ\mathrm{C}$。把它投入一个标准大气压下的一大锅沸水中，经过多少秒之后内壁温度可以到达 $99^\circ\mathrm{C}$？
  
（结果请精确到秒）

\end{frame}

\begin{frame}
  记 $T_0=100^\circ\mathrm{C}$，$R=0.1\mathrm{m}$，并令$u = T - T_0$ (即去除稳定解)，则有
  \bea
  \frac{\partial u}{\partial t} - a\nabla^2 u &=& 0, \newl
  \left. u\right\vert_{r=2R} &=& 0 ,\newl
  \left. \frac{\partial u}{\partial r}\right\vert_{r=R} &=& 0, \newl
  \left. u\right\vert_{t=0} = -T_0,
  \eea
\end{frame}


\begin{frame}
      由对称性知道可以把$u$展开为$j_0(kr)e^{-ak^2t}$和$n_0(kr)e^{-ak^2t}$的线性组合。而
      $$j_0(kr) = \frac{\sin(kr)}{kr};  n_0(kr) = -\frac{\cos(kr)}{kr}, $$
      的线性组合要满足$r=2R$处为零，$r=R$处对$r$的偏导数为零，只有下述可能性：
      $$ \frac{\sin\frac{\mu_i(r-2R)}{R}}{r},$$
      $\mu_i$是按从小到大排列的第$i$个满足
      $$ \tan \mu + \mu = 0 $$
      的正实数根。 %($\mu_1=2.02876$, $\mu_2 = 4.91318$, $\mu_3 = 7.97867$, $\mu_4 = 11.0855$, $\mu_5 = 14.20744$ \ldots)。

\end{frame}

\begin{frame}
      按套路令
      $$ u = \sum_{i}c_i \frac{\sin\frac{\mu_i(r-2R)}{R}}{r} e^{-\frac{a\mu_i^2t}{R^2}}, $$
      根据初始条件
      $$\sum_{i}c_i \frac{\sin\frac{\mu_i(r-2R)}{R}}{r}  = -T_0$$      
      剩下的问题就是用上面的等式，计算正交展开的系数$c_i$。
\end{frame}

\begin{frame}
      根据谐函数的正交定理
      $$ \int_R^{2R} \frac{\sin\frac{\mu_i(r-2R)}{R}}{r} \frac{\sin\frac{\mu_j(r-2R)}{R}}{r} r^2dr = \delta_{ij} N_i,$$
      其中$N_i$是需要花点精力计算的归一化因子：
      \bea
      N_i &=& \int_R^{2R} \sin^2\frac{\mu_i(r-2R)}{R} dr \newl
      &=& \frac{R}{2}\left(1-\frac{\sin 2\mu_i}{2\mu_i} \right) \newl
      &=&  \frac{R}{2}\left(1-\frac{2\tan\mu_i}{2\mu_i(1+\tan^2\mu_i)}\right) \newl
      &=& \frac{R(2+\mu_i^2)}{2(1+\mu_i^2)}. \nonumber
      \eea
\end{frame}

\begin{frame}
      于是根据初始条件进行投影得到：
      \bea
      c_i &=& -\frac{T_0}{N_i}\int_R^{2R} \frac{\sin\frac{\mu_i(r-2R)}{R}}{r}  r^2dr \newl
      &=& \frac{T_0}{N_i} \frac{R}{\mu_i}  \left[ \left. r \cos\frac{\mu_i(r-2R)}{R}\right\vert_{R}^{2R} -   \int_R^{2R}\cos\frac{\mu_i(r-2R)}{R} dr\right] \newl
      &=& \frac{T_0}{N_i} \frac{R}{\mu_i}  \left[ (2-\cos\mu_i)R -   \frac{R}{\mu_i} \left.\sin\frac{\mu_i(r-2R)}{R} \right\vert_{R}^{2R}\right] \newl
      &=& \frac{T_0}{N_i} \frac{R}{\mu_i}  \left[ (2-\cos\mu_i)R -   \frac{R}{\mu_i} \sin\mu_i\right]\newl
      &=& \frac{2T_0R^2}{N_i\mu_i} \newl
      &=& \frac{4T_0R(1+\mu_i^2)}{\mu_i(2+\mu_i^2)} \nonumber
      \eea
\end{frame}


\begin{frame}
      最后结果就是
      {\blue $$ T = T_0 \left[1+4\sum_{i}\frac{(1+\mu_i^2)}{\mu_i(2+\mu_i^2)} \frac{R}{r} \sin\frac{\mu_i(r-2R)}{R} e^{-\frac{a\mu_i^2t}{R^2}}\right]. $$}
      取其衰减最慢的一项作为近似，在内壁$r=R$：
      $$ 1-\frac{4(1+\mu_1^2)  \sin\mu_1 }{\mu_1(2+\mu_1^2)}e^{-\frac{a\mu_1^2t}{R^2}} \approx 0.99 $$
      于是我们需要明确地求出 $\mu_1$.
\end{frame}


\begin{frame}
  为了求解
  $$\tan \mu + \mu = 0$$
  简单地画 $y=\tan \mu$和 $y=-\mu$的图，并观察交点分布，可以判断$\frac{\pi}{2}<\mu_1<\pi$.
  
  不妨设 $\mu_1 = \frac{\pi}{2}+\epsilon$ （$0<\epsilon<\frac{\pi}{2}$)，则可以得到
    $$ \tan \epsilon=\frac{1}{\frac{\pi}{2}+\epsilon}.$$
    作为粗略的近似，我们先忽略右边的$\epsilon$，求出零阶近似解： $\epsilon\approx \arctan \frac{2}{\pi} = 0.5669$.

    然后把零阶近似解代入到右边求出一阶近似解：$\epsilon\approx \arctan \frac{1}{\frac{\pi}{2}+0.567} = 0.43755 $.
\end{frame}    

\begin{frame}
    再迭代一次得到二阶近似： $\epsilon\approx \arctan \frac{1}{\frac{\pi}{2}+0.43755} = 0.46198 $.

    再迭代一次，得到三阶近似： $\epsilon\approx \arctan \frac{1}{\frac{\pi}{2}+0.46198} = 0.45719 $.

    再迭代一次，得到四阶近似： $\epsilon\approx \arctan \frac{1}{\frac{\pi}{2}+0.46198} = 0.45811 $.

    反正都迭代那么多次也不在乎多一次了： $\epsilon\approx \arctan \frac{1}{\frac{\pi}{2}+0.45811} = 0.45793 $.

    再迭代一次反正也不会死人： $\epsilon\approx \arctan \frac{1}{\frac{\pi}{2}+0.45793} = 0.45796 $.
    
    这样我们得到 $\mu_1\approx \frac{\pi}{2}+\epsilon \approx 2.02876$.
\end{frame}

\begin{frame}
  于是由
  $$ \frac{4(1+\mu_1^2) \sin\mu_1}{\mu_1(2+\mu_1^2)}  e^{-\frac{a\mu_1^2t}{R^2}} \approx 0.01 $$
  可以反解出
  $$ t = \frac{R^2}{a\mu_1^2} \ln \frac{400(1+\mu_1^2)\sin\mu_1 }{\mu_1(2+\mu_1^2)}   \approx 1.214\frac{R^2}{a}=121.4\mathrm{s}$$
\end{frame}

\section{Nonlinear ODE}

\begin{frame}
  \frametitle{自由下落的雨滴}
  假设质量为$m$的雨滴一开始静止，在重力的作用下垂直下落，其所受空气阻力$f$和速率$\upsilon$的平方成正比：
  $$ f = \mu \upsilon^2 . $$  
  假设重力加速度$g$随高度的变化可以忽略，写出雨滴下落高度 (作为时间的函数) $y(t)$ 满足的微分方程和初始条件。
\end{frame}

\begin{frame}
  \frametitle{非线性的微分方程}
  取合适的单位后，雨滴下落的速度 $\upsilon$ 可以用下述非线性微分方程来描述：

  $$ \dot \upsilon + \upsilon^2=1,$$

  $$\upsilon(0) = 0.$$
\end{frame}


\begin{frame}
  \frametitle{严格解}
  上述方程其实有严格解：

  $$ \upsilon = \tanh(t) $$


  我们下面要讨论的不是怎么凑这个严格解，而是怎样用近似的解法去求解非线性微分方程。
  
  之所以选取这样一个（运气好）可以凑出严格解的简单问题作为例子：一是为了尽可能避开繁琐的描述，抓住方法的本质； 二是为了可以用严格解客观地检验各种近似方法好坏。
  
\end{frame}

\subsection{Series method}

\begin{frame}
  \frametitle{微扰(级数)法}
  虽然整个问题看起来挺难， 但当$t$比较小的时候，可以尝试一下级数解
  $$ \upsilon =\sum_{n=0}^\infty c_n t^n $$
  利用初始条件可以确定 $c_0=0$，于是代入原方程得到
  $$ \sum_{n=1}^\infty \left[(n+1)c_{n+1}+\sum_{k=1}^nc_kc_{n-k}\right] t^n = 1.$$
  
\end{frame}  

\begin{frame}
  \frametitle{微扰(级数)法}
  令 $n=0$，得到 $c_1=1$，然后逐项递推得到

  $$ \upsilon = t - \frac{1}{3}t^3+\frac{2}{15}t^5 - \frac{17}{315}t^7+\ldots.$$

  这其实就是 $\tanh t$在 $t=0$ 的邻域的展开，虽说级数只在 $t=0$附近的小范围内收敛，但是可以解析延拓这个级数解使得它在 $t\in(0,\infty)$内都适用。

  \skipline
  
  然而这一切美好的假象都源于我们选取了一个简单的有初等函数解的问题。{\blue 一般来说，这种粗暴展开的方法得到的解只在很有限的范围内收敛，也没有很好的方法进行解析延拓。} 
\end{frame}  

\subsection{Lyapunov method}

\begin{frame}
  \frametitle{另一种观点的微扰法 (Lyapunov小参数法）}
  Lyapunov小参数法把非线性项看作“微扰项”，
  $$ \dot\upsilon + \epsilon \upsilon^2 = 1,\ \  \upsilon(0)=0$$
  这里的 $\epsilon$ 是一个形式小量。在做形式推导时我们把 $\epsilon$ 当成无穷小量，但实际上最后我们是要让 $\epsilon = 1$。
  
  考虑逐级近似解:
  $$\upsilon(t) = \upsilon_0(t) + \epsilon \upsilon_1(t) + \epsilon^2 \upsilon_2(t)+\ldots$$
  代入上述修改过的微分方程，并逐项对比 $\epsilon$各次系数，就得到各级近似解满足
\end{frame}

\begin{frame}
  \frametitle{另一种观点的微扰法 (Lyapunov小参数法）}
    $$\dot \upsilon_0  = 1, \upsilon_0(0) = 0.$$
    $$\dot \upsilon_1+\upsilon_0^2  = 0, \upsilon_1(0) = 0.$$
    $$\dot \upsilon_2+ 2\upsilon_0\upsilon_1  = 0, \upsilon_2(0) = 0.$$        
    $$\ldots$$
\end{frame}

\begin{frame}
  \frametitle{另一种观点的微扰法 (Lyapunov小参数法）}
    由此解出
    $$\upsilon_0 = t; $$
    $$\upsilon_1 = -\frac{t^3}{3};$$
    $$\upsilon_2 = \frac{2t^5}{15};$$    
    $$ \ldots$$

   最后令 $\epsilon = 1$，就得到和之前暴力展开法相同的（只在一定范围内有效的）结果。
\end{frame}


\subsection{Index-Perturbation Method}

\begin{frame}
  \frametitle{指数上的微扰}
  我们再尝试一种看起来很奇怪的方法，把方程写成
  $$ \dot \upsilon + \upsilon^{1+\epsilon} = 1,\ \ \upsilon(0)=0$$
  并把 $\epsilon$ 看成一个形式上的无穷小量。实际上我们最后会令 $\epsilon = 1$.

  考虑逐级近似解:
  $$\upsilon(t) = \upsilon_0(t) + \epsilon \upsilon_1(t) + \epsilon^2 \upsilon_2(t)+\ldots$$
  代入上述修改过的微分方程，注意到
 $$ \upsilon^{1+\epsilon} = \upsilon_0+(\upsilon_1+\upsilon_0\ln\upsilon_0)\epsilon + \left[\upsilon_1(1+\ln\upsilon_0)+\frac{1}{2}\upsilon_0\ln^2\upsilon_0+\upsilon_2\right]\epsilon^2+\ldots $$
  逐项对比 $\epsilon$各次系数，就得到各级近似解满足
\end{frame}


\begin{frame}
  \frametitle{指数上的微扰}
  $$ \dot\upsilon_0+\upsilon_0 =1, \ \upsilon_0(0)= 0;$$
  $$ \dot\upsilon_1+\upsilon_1 =-\upsilon_0\ln\upsilon_0, \ \upsilon_1(0)= 0;$$
  $$ \dot\upsilon_2+\upsilon_2 =-\upsilon_1(1+\ln\upsilon_0)-\frac{1}{2}\upsilon_0\ln^2\upsilon_0, \ \upsilon_2(0)= 0;$$    
  $$\ldots $$
\end{frame}


\begin{frame}
  \frametitle{指数上的微扰}
  解这一系列方程，得到：

  $$ \upsilon_0 = 1-e^{-t}.$$
  $$ \upsilon_1 = e^{-t}\left(t-\frac{\pi^2}{6}+\sum_{n=1}^\infty\frac{e^{-nt}}{n^2}\right)-\left(1-e^{-t}\right)\ln\left(1-e^{-t}\right).$$  
 \ \ （后面实在解不动了）
\end{frame}


\begin{frame}
  \frametitle{指数上的微扰}
  最后我们令$\epsilon=1$得到近似解
  $$ \upsilon = 1+e^{-t}\left(t-\frac{\pi^2}{6}-1+\sum_{n=1}^\infty\frac{e^{-nt}}{n^2}\right)-\left(1-e^{-t}\right)\ln\left(1-e^{-t}\right)+\ldots.$$
  这个解就在 $(0,\infty)$内收敛了，并且是个“还算过得去”的近似。

  要得到稍好一点的近似（即 $\upsilon_2$的解），计算量实在太可怕了，不过在计算机上这也许问题不大。

  {\scriptsize 你可能会疑惑：如果允许用计算机，为啥不直接求解原方程？这是因为非线性微分方程的直接数值求解很容易产生不可预知的误差，而线性微分方程的数值误差很好控制。}
  
\end{frame}


\begin{frame}
  \frametitle{总结与思考}
  \bitem
\item{非线性问题即使在计算机上也很容易产生不可控的误差，往往需要解析方法的辅助。}
\item{各种“扰动法”是解决非线性问题的基础，但是扰动的方法不同，解的好坏差别很大。}
\item{在我们讨论的例子里，指数扰动之所以远远优于简单粗暴的扰动，是因为它本质上是在线性方程 $\frac{d\upsilon}{dt} + \upsilon=1$ 的解附近做的微扰展开。这个线性方程的解和原方程的解有类似的渐近行为。}  
  \eitem
  
\end{frame}

\begin{frame}
  \frametitle{进阶知识：同伦方法}
  设$\mathcal{N}$是一个非线性算符，我们希望求解非线性方程
  $$\mathcal{N}\left[u(t)\right]= 0,  $$
  假设我们猜了一个非常粗略的近似解 $u_0(t)$，然后考虑满足下列微分方程的函数族 $\Phi(t; q)$，
  $$(1-q)\mathcal{L}\left[\Phi(t;q)-u_0(t)\right] + q\mathcal{N}\left[\Phi(t;q)\right] = 0.$$
  这里的 $q$ 是辅助参数，允许从 $0$ 连续变化至  $1$。算符$\mathcal{L}$是（瞎蒙的）能给出类似的解的渐近行为的{\bf 线性算符}。我们要求 $\Phi(t;q)$ 满足和 $u(t)$ 一样的初始条件。

\end{frame}

\begin{frame}
  \frametitle{进阶知识：同伦方法}
  当 $q=0$ 时，显然 $\Phi(t;0)= u_0(t)$ 是上述方程的解。

  而当 $q=1$时，上述方程的解将变成 $\Phi(t;1) = u(t)$ （这是因为方程变成了 $\mathcal{N}\left[\Phi(t;1)\right] = 0.$)。

    \skipline

    也就是说, $q$连续地从 $0$ 变到 $1$，解 $\Phi(t;q)$ 就连续地从粗略的近似解 $u_0(t)$ 变化到了 严格解 $u(t)$。

    \skipline
    
    把$q$当成形式小量，解上述方程并最后令 $q=1$ 的方法称为同伦方法(homotopy method)。其核心成功因素是“猜”。只要你天赋异禀，永远都能把$u_0$和 $\mathcal{L}$猜得很好，非线性问题对你来说就是小菜一碟……
  
\end{frame}


\ech
\end{document}
